#!/usr/bin/env bash
path="/media/elektroline"

usage() {
	echo "Usage: $0 [OPTION].." >&2
}

umount="n"
while getopts "u" opt; do
	case "$opt" in
	u)
		umount="y"
		;;
	*)
		usage
		exit 2
		;;
	esac
done

if [ "$umount" = "n" ]; then
	mount_cifs() {
		sudo mkdir -p "$path/$2"
		sudo --preserve-env=PASSWD mount.cifs -o username=kkoci,uid=1000 "$1" "$path/$2"
		echo "Mounted $path/$2"
	}

	sudo mkdir -p "$path"
	export PASSWD
	PASSWD="$(pass elektroline.cz/kkoci)"
	mount_cifs "//czelldata.elektroline.cz/Share" "share"
	mount_cifs "//10.0.0.3/company" "company"
	mount_cifs "//10.0.0.3/elektro_doc" "elektro_doc"
else
	sudo umount "$path"/{share,company,elektro_doc}
fi
