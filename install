#!/bin/bash

cd `dirname $0`

# TODO arguments parsing
git submodule update --init || (echo "Submodule update failed! Use --ignore-sub if it's ok."; exit 5)

# Source inst and diff function
. ./utils/inst

#################################################################################
source private/install # private files, sorry but some privacy is required.

if [ -e /etc/arch-release ]; then
	. ./utils/arch
	read -p "Chek Archlinux packages? (Y/n) "
	if [[ $REPLY =~ ^[Yy]?$ ]]; then
		archlinux_inst
	fi
fi

read -p "Install Bashrc? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst bashrc ~/.bashrc
	inst shellrc ~/.shellrc
	inst profile ~/.profile
fi

read -p "Install zshrc? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst zshrc ~/.zshrc
	inst shellrc ~/.shellrc
	inst zprofile ~/.zprofile
fi

read -p "Install GIT configuration? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst gitconfig ~/.gitconfig
	inst local/git-prompt.sh ~/.local/
fi

read -p "Install VIM scripts? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst vimrc ~/.vimrc
	inst vim/ ~/.vim
	inst local/bin/vim-project-gen ~/.local/bin/vim-project-gen
	mkdir -p ~/.cache/vim # directory for *.swp files
	mkdir -p ~/.cache/vim-undo # directory for undo files
	echo "Please don't forget to setup YouCompleteMe"
fi

read -p "Install ranger configuration? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst config/ranger/rc.conf ~/.config/ranger/rc.conf
	inst config/ranger/rifle.conf ~/.config/ranger/rifle.conf
	inst config/ranger/scope.sh ~/.config/ranger/scope.sh
fi

read -p "Install email synchronization? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst_email_sync
	# Contains:
	# inst local/sbin/syncemail ~/.local/sbin/
	# inst config/offlineimap/ ~/.config/offlineimap
fi

read -p "Install mutt configuration? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst urlview ~/.urlview
	inst mutt/mailcap ~/.mutt/
	inst mutt/gpg.rc ~/.mutt/
	inst mutt/color ~/.mutt/
	inst_mutt_conf
	# Contains:
	# inst mutt/ ~/.mutt
	# inst msmtprc ~/.msmtprc
	mkdir -p ~/.cache/mutt # directory for temporaly html files
fi

read -p "Install i3 configuration and related tools? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst xinitrc ~/.xinitrc
	inst Xresources ~/.Xresources
	inst config/i3/ ~/.config/i3
	inst config/i3blocks/ ~/.config/i3blocks
	inst config/i3status/ ~/.config/i3status
	inst config/dunst/ ~/.config/dunst
	inst local/bin/mxrandr ~/.local/bin/
	inst local/bin/sys-reboot ~/.local/bin/
	inst local/bin/sys-shutdown ~/.local/bin/
	inst local/bin/sys-suspend ~/.local/bin/
fi

read -p "Install Conkeror configuration? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst conkerorrc ~/.conkerorrc
	inst conkeror/ ~/.conkeror
fi

read -p "Install MPD configuration? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst config/mpd/ ~/.config/mpd
fi

read -p "Install backup script? (Y/n) "
if [[ $REPLY =~ ^[Yy]?$ ]]; then
	inst local/bin/system-backup ~/.local/bin/system-backup
fi
